exec cue export -e out --out yaml ./apps/...
cmp stdout golden.yaml

-- apps/foo.cue --
package app

out: (#App & {config: {
	name: "foo"
	common: namespace: "default"

	ingress: "foo-ingress": {
		type: "Ingress"
		hostnames: ["foo.example.com"]
		serviceName: "foo-service"
		servicePort: 80
		spec: tls: [{hosts: hostnames}]
	}

	ingress: "foo-httproute": {
		type: "HTTPRoute"
		hostnames: ["foo.example.com"]
		serviceName: "foo-service"
		servicePort: 80
		spec: parentRefs: [{
			name: "internal"
		}]
	}

	ingress: "route-with-timeout": {
		type: "HTTPRoute"
		hostnames: ["foo.example.com"]
		serviceName: "foo-service"
		servicePort: 80
		spec: parentRefs: [{
			name: "internal"
		}]
		ruleSpec: timeouts: {
			request: "60m"
			backendRequest: "60m"
		}
	}

	ingress: "foo-tcproute": {
		type: "TCPRoute"
		serviceName: "foo-service"
		servicePort: 80
		spec: parentRefs: [{
			name: "internal"
			namespace: "envoy-gateway"
		}]
	}

}}).out

-- golden.yaml --
- apiVersion: networking.k8s.io/v1
  kind: Ingress
  metadata:
    name: foo-ingress
    namespace: default
    labels:
      app.kubernetes.io/name: foo
  spec:
    tls:
      - hosts:
          - foo.example.com
    rules:
      - host: foo.example.com
        http:
          paths:
            - backend:
                service:
                  name: foo-service
                  port:
                    number: 80
              path: /
              pathType: Prefix
- apiVersion: gateway.networking.k8s.io/v1
  kind: HTTPRoute
  metadata:
    name: foo-httproute
    namespace: default
    labels:
      app.kubernetes.io/name: foo
  spec:
    hostnames:
      - foo.example.com
    parentRefs:
      - name: internal
    rules:
      - backendRefs:
          - name: foo-service
            port: 80
        matches:
          - path:
              type: PathPrefix
              value: /
- apiVersion: gateway.networking.k8s.io/v1
  kind: HTTPRoute
  metadata:
    name: route-with-timeout
    namespace: default
    labels:
      app.kubernetes.io/name: foo
  spec:
    hostnames:
      - foo.example.com
    parentRefs:
      - name: internal
    rules:
      - backendRefs:
          - name: foo-service
            port: 80
        matches:
          - path:
              type: PathPrefix
              value: /
        timeouts:
          backendRequest: 60m
          request: 60m
- apiVersion: gateway.networking.k8s.io/v1alpha2
  kind: TCPRoute
  metadata:
    name: foo-tcproute
    namespace: default
    labels:
      app.kubernetes.io/name: foo
  spec:
    parentRefs:
      - name: internal
        namespace: envoy-gateway
    rules:
      - backendRefs:
          - name: foo-service
            port: 80
